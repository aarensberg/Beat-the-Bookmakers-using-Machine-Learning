# Applied Machine Learning for Business — Football Betting Probabilities

![Cover Project](cover_project.png)

This repository contains a complete end‑to‑end pipeline to model football match outcomes and evaluate betting strategies using the **European Soccer Database** (SQLite). The work is implemented in the notebooks and produces summary tables in the `results/` folder.

## Project Summary

The workflow follows these steps:

1. **Dataset construction (match level)**  
   - Load `Match`, `League`, `Team` tables.
   - Filter to *England Premier League* and *France Ligue 1*.
   - Create the target label `result ∈ {H, D, A}`.
   - Compute margin‑adjusted implied probabilities from Bet365 odds.

2. **Team form features**  
   Rolling features over the last $N=5$ matches (goals for/against, points, win rate) for home and away teams.

3. **Team attributes**  
   Attach FIFA `Team_Attributes` using the most recent attributes **prior** to each match date; add home/away differences.

4. **Models**  
   - Multinomial Logistic Regression  
   - XGBoost (with and without odds)  
   - XGBoost with isotonic calibration

5. **Bet embedding & EV**  
   Build a `bets` dataset (one row per outcome per match) with  
   $ \text{EV} = p \cdot \text{odds} - 1 $.

6. **Backtests & optimization**  
   Simple strategies (R1/R2/R3), bankroll simulations, and linear optimization of stakes.

## Repository Structure

- [analyses.ipynb](analyses.ipynb) — main notebook (English)
- [analyses_fr.ipynb](analyses_fr.ipynb) — French notebook with detailed steps
- [results/](results/) — CSV tables and figures generated by the notebook
- [db_diagrams/](db_diagrams/) — database diagrams (optional reference)
- [requirements.txt](requirements.txt) — Python dependencies
- [instructions.pdf](instructions.pdf) — project instructions

## How to Run

1. **Install dependencies**
   ```bash
   pip install -r requirements.txt
   ```
2. **Download the database**
   Place `database.sqlite` in the project root (it is excluded by `.gitignore`).
3. **Run the notebook**
   Open [analyses.ipynb](analyses.ipynb) in VS Code / Jupyter and run all cells in order.